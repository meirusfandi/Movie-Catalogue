package com.meirusfandi.cataloguemovie.views.favorite;import android.content.Context;import android.net.Uri;import android.os.Build;import android.os.Bundle;import android.os.Handler;import android.os.Parcelable;import android.support.annotation.NonNull;import android.support.annotation.Nullable;import android.support.annotation.RequiresApi;import android.support.v4.app.Fragment;import android.support.v4.widget.SwipeRefreshLayout;import android.support.v7.widget.LinearLayoutManager;import android.support.v7.widget.RecyclerView;import android.util.Log;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import com.meirusfandi.cataloguemovie.R;import com.meirusfandi.cataloguemovie.data.MovieModel;import com.meirusfandi.cataloguemovie.data.local.MovieHelper;import com.meirusfandi.cataloguemovie.helper.MovieAdapter;import java.util.ArrayList;import java.util.Objects;import butterknife.BindView;import butterknife.ButterKnife;public class FavoriteFragment extends Fragment {    @BindView(R.id.recycler_favorite)    RecyclerView recyclerView;    @BindView(R.id.swipe)    SwipeRefreshLayout swipe;    MovieAdapter movieAdapter;    MovieHelper movieHelper;    ArrayList<MovieModel> movieModels;    @RequiresApi(api = Build.VERSION_CODES.KITKAT)    @Override    public void onViewCreated(@NonNull View view, Bundle savedInstanceState) {        super.onViewCreated(view, savedInstanceState);        Objects.requireNonNull(getActivity()).setTitle(R.string.bar_favorit);        ButterKnife.bind(this, view);        movieModels = new ArrayList<>();        movieAdapter = new MovieAdapter(movieModels, getContext());        recyclerView.setLayoutManager(new LinearLayoutManager(getContext()));        recyclerView.setAdapter(movieAdapter);        if (savedInstanceState == null){            getData();        }//        else {//            ArrayList<MovieModel> myMovies;//            myMovies = savedInstanceState.getParcelableArrayList("movie");//            movieAdapter.setMovieModels(myMovies);//            movieAdapter.notifyDataSetChanged();//            recyclerView.setAdapter(movieAdapter);//        }        swipe.setColorScheme(android.R.color.holo_blue_bright,                android.R.color.holo_green_light,                android.R.color.holo_orange_light,                android.R.color.holo_red_light);        swipe.setOnRefreshListener(new SwipeRefreshLayout.OnRefreshListener() {            @Override            public void onRefresh() {                new Handler().postDelayed(new Runnable() {                    @Override                    public void run() {                        swipe.setRefreshing(false);                        getData();                    }                }, 3000);            }        });    }    public void getData(){        movieHelper = new MovieHelper(getContext());        movieHelper.open();        ArrayList<MovieModel> movieModel = movieHelper.getAllMovie();        movieHelper.close();        for (int i=0; i<movieModel.size(); i++){            Log.e("id", movieModel.get(i).getRelease());        }        movieAdapter.setMovieModels(movieModel);        movieAdapter.notifyDataSetChanged();    }    @RequiresApi(api = Build.VERSION_CODES.KITKAT)    @Override    public void onActivityCreated(@Nullable Bundle savedInstanceState) {        super.onActivityCreated(savedInstanceState);        if (savedInstanceState != null){            ArrayList<MovieModel> movies;            movies = Objects.requireNonNull(savedInstanceState).getParcelableArrayList("movie");            movieAdapter.setMovieModels(movies);            recyclerView.setAdapter(movieAdapter);            movieAdapter.notifyDataSetChanged();        }    }    @Override    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,                             Bundle savedInstanceState) {        // Inflate the layout for this fragment        return inflater.inflate(R.layout.fragment_favorite, container, false);    }    @Override    public void onSaveInstanceState(@NonNull Bundle outState) {        super.onSaveInstanceState(outState);        movieModels = movieHelper.getAllMovie();        movieAdapter = new MovieAdapter(movieModels, getContext());        movieAdapter.notifyDataSetChanged();        outState.putParcelableArrayList("movie", new ArrayList<Parcelable>(movieAdapter.getMovieModels()));    }    @Override    public void onAttach(Context context) {        super.onAttach(context);    }    @Override    public void onDetach() {        super.onDetach();    }    public interface OnFragmentInteractionListener {        // TODO: Update argument type and name        void onFragmentInteraction(Uri uri);    }}